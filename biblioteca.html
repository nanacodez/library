<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Biblioteca Web</title>
    <style>
        /* CSS B√°sico para deixar bonito */
        body { font-family: sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; background-color: #f4f4f9; }
        h1 { color: #333; text-align: center; }
        
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        
        button { background-color: #28a745; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; width: 100%; font-size: 16px; }
        button:hover { background-color: #218838; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #007bff; color: white; }
        
        .btn-devolver { background-color: #dc3545; padding: 5px 10px; font-size: 12px; }
        .btn-devolver:hover { background-color: #c82333; }
        
        /* Destaque para atrasados */
        .atrasado { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <h1>üìö Controle de Empr√©stimos</h1>

    <div class="card">
        <div class="form-group">
            <label>Nome da Pessoa:</label>
            <input type="text" id="inputNome" placeholder="Ex: Maria Silva">
        </div>
        <div class="form-group">
            <label>Nome do Livro:</label>
            <input type="text" id="inputLivro" placeholder="Ex: Dom Casmurro">
        </div>
        <div style="display: flex; gap: 10px;">
            <div class="form-group" style="flex: 1;">
                <label>Data de Retirada:</label>
                <input type="date" id="inputDataRetirada">
            </div>
            <div class="form-group" style="flex: 1;">
                <label>Data de Devolu√ß√£o:</label>
                <input type="date" id="inputDataDevolucao">
            </div>
        </div>
        <button onclick="cadastrarEmprestimo()">Registrar Empr√©stimo</button>
    </div>

    <div class="card">
        <h3>Empr√©stimos Ativos</h3>
        <table id="tabelaEmprestimos">
            <thead>
                <tr>
                    <th>Leitor</th>
                    <th>Livro</th>
                    <th>Retirada</th>
                    <th>Devolu√ß√£o</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <script>
        // --- L√ìGICA DO SISTEMA ---

        // 1. Array para guardar os dados (nosso "banco de dados" local)
        let listaEmprestimos = [];

        // Ao carregar a p√°gina, define a data de hoje nos inputs para facilitar
        window.onload = () => {
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById("inputDataRetirada").value = hoje;
        };

        // 2. Fun√ß√£o C (Create) - Cadastrar
        function cadastrarEmprestimo() {
            // Pegando os valores dos inputs HTML
            const nome = document.getElementById("inputNome").value;
            const livro = document.getElementById("inputLivro").value;
            const dataRetirada = document.getElementById("inputDataRetirada").value;
            const dataDevolucao = document.getElementById("inputDataDevolucao").value;

            // Valida√ß√£o simples
            if (nome === "" || livro === "" || dataDevolucao === "") {
                alert("Por favor, preencha todos os campos!");
                return;
            }

            // Criando o objeto do empr√©stimo
            const novoEmprestimo = {
                id: Date.now(), // Gera um ID √∫nico baseado no tempo
                nome: nome,
                livro: livro,
                dataRetirada: dataRetirada,
                dataDevolucao: dataDevolucao
            };

            // Adiciona na lista
            listaEmprestimos.push(novoEmprestimo);

            // Limpa os campos
            document.getElementById("inputNome").value = "";
            document.getElementById("inputLivro").value = "";
            
            // Atualiza a tela
            renderizarTabela();
        }

        // 3. Fun√ß√£o R (Read) - Mostrar na tela
        function renderizarTabela() {
            const tbody = document.querySelector("#tabelaEmprestimos tbody");
            tbody.innerHTML = ""; // Limpa a tabela antes de redesenhar

            listaEmprestimos.forEach(emprestimo => {
                // Formatar datas para o padr√£o brasileiro (dd/mm/aaaa)
                const dataR = new Date(emprestimo.dataRetirada).toLocaleDateString('pt-BR', {timeZone: 'UTC'});
                const dataD = new Date(emprestimo.dataDevolucao).toLocaleDateString('pt-BR', {timeZone: 'UTC'});

                // Cria a linha da tabela (tr)
                const tr = document.createElement("tr");

                tr.innerHTML = `
                    <td>${emprestimo.nome}</td>
                    <td>${emprestimo.livro}</td>
                    <td>${dataR}</td>
                    <td>${dataD}</td>
                    <td>
                        <button class="btn-devolver" onclick="devolverLivro(${emprestimo.id})">
                            Devolver
                        </button>
                    </td>
                `;

                tbody.appendChild(tr);
            });
        }

        // 4. Fun√ß√£o D (Delete) - Remover da lista
        function devolverLivro(id) {
            if(confirm("Confirmar a devolu√ß√£o deste livro?")) {
                // Filtra a lista mantendo apenas quem N√ÉO tem esse ID
                listaEmprestimos = listaEmprestimos.filter(item => item.id !== id);
                renderizarTabela();
            }
        }
    </script>
</body>
</html>